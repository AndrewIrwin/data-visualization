<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 22 Multidimensional scaling | Data Visualization</title>
<meta name="author" content="Andrew Irwin">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.4/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Visualization</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="syllabus.html">Syllabus</a></li>
<li><a class="" href="outline.html">Detailed outline</a></li>
<li><a class="" href="sync.html">Synchronous meeting agendas</a></li>
<li><a class="" href="evaluation.html">Evaluation</a></li>
<li><a class="" href="ch-invitation.html"><span class="header-section-number">1</span> Invitation to Data Visualization</a></li>
<li><a class="" href="ch-tools.html"><span class="header-section-number">2</span> Computer tools</a></li>
<li><a class="" href="setup.html"><span class="header-section-number">3</span> Setting up your computer</a></li>
<li><a class="" href="look-data.html"><span class="header-section-number">4</span> Look at Data</a></li>
<li><a class="" href="first-plot.html"><span class="header-section-number">5</span> Making your first plot</a></li>
<li><a class="" href="vcs.html"><span class="header-section-number">6</span> What is version control software?</a></li>
<li><a class="" href="grammar.html"><span class="header-section-number">7</span> Grammar of Graphics</a></li>
<li><a class="" href="ggplot.html"><span class="header-section-number">8</span> Using the grammar of graphics</a></li>
<li><a class="" href="summarizing-data.html"><span class="header-section-number">9</span> Summarizing data</a></li>
<li><a class="" href="facets.html"><span class="header-section-number">10</span> Facetted graphs</a></li>
<li><a class="" href="reading-data.html"><span class="header-section-number">11</span> Reading data</a></li>
<li><a class="" href="pivot.html"><span class="header-section-number">12</span> Reshaping data</a></li>
<li><a class="" href="format-tables.html"><span class="header-section-number">13</span> Format tables</a></li>
<li><a class="" href="help.html"><span class="header-section-number">14</span> Getting help and asking questions</a></li>
<li><a class="" href="working-models.html"><span class="header-section-number">15</span> Working with models</a></li>
<li><a class="" href="linear-models.html"><span class="header-section-number">16</span> Linear models</a></li>
<li><a class="" href="smoothing.html"><span class="header-section-number">17</span> GAM and LOESS smoothing</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">18</span> Collaborating with GitHub</a></li>
<li><a class="" href="data-sources.html"><span class="header-section-number">19</span> Finding and accessing data</a></li>
<li><a class="" href="reproduce.html"><span class="header-section-number">20</span> Reproducible reports</a></li>
<li><a class="" href="pca.html"><span class="header-section-number">21</span> Principal component analysis</a></li>
<li><a class="active" href="mds.html"><span class="header-section-number">22</span> Multidimensional scaling</a></li>
<li><a class="" href="k-means.html"><span class="header-section-number">23</span> K-means clustering</a></li>
<li><a class="" href="slides.html"><span class="header-section-number">24</span> Making slides for presentations</a></li>
<li><a class="" href="dynamic.html"><span class="header-section-number">25</span> Dynamic graphics</a></li>
<li><a class="" href="mapping-1.html"><span class="header-section-number">26</span> Making maps</a></li>
<li><a class="" href="mapping-2.html"><span class="header-section-number">27</span> Mapping part two</a></li>
<li><a class="" href="mapping-3.html"><span class="header-section-number">28</span> Alternatives to maps</a></li>
<li><a class="" href="factors-dates.html"><span class="header-section-number">29</span> Working with factors and dates</a></li>
<li><a class="" href="colour.html"><span class="header-section-number">30</span> Using colour well</a></li>
<li><a class="" href="theme.html"><span class="header-section-number">31</span> Themes</a></li>
<li><a class="" href="output-files.html"><span class="header-section-number">32</span> Graphics formatting</a></li>
<li><a class="" href="organization.html"><span class="header-section-number">33</span> Staying organized</a></li>
<li><a class="" href="r-details.html"><span class="header-section-number">34</span> More details about R</a></li>
<li><a class="" href="accessibility-bias-and-ethics.html"><span class="header-section-number">35</span> Accessibility, Bias, and Ethics</a></li>
<li><a class="" href="metadata.html">Metadata</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/AndrewIrwin/data-visualization">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="mds" class="section level1" number="22">
<h1>
<span class="header-section-number">22</span> Multidimensional scaling<a class="anchor" aria-label="anchor" href="#mds"><i class="fas fa-link"></i></a>
</h1>
<p>Multidimensional scaling (MDS) is another approach to ordination. The purpose is similar to the goals of PCA, but the methods are a bit different. With MDS, the starting point is a similarity, or distance matrix, providing measurements between all pairs of data. Many different <a href="https://pages.mtu.edu/~shanem/psy5220/daily/Day16/MDS.html#:~:text=Multidimentional%20scaling%20(MDS)%20is%20used,measures%20between%20objects%20or%20cases.">functions</a> can be used to compute this similarity matrix. Commonly distance functions are used. If quantitative data have very skewed distributions, or there is no good way to interpret the distance between points, the data may be converted to ranks (1, 2, 3, …) before the similarity measure is computed; then the method is called non-metric multidimensional scaling (NMDS) in recognition of the fact that the information being presented is not related to a distance.</p>
<div id="cities-on-a-map" class="section level3" number="22.0.1">
<h3>
<span class="header-section-number">22.0.1</span> Cities on a map<a class="anchor" aria-label="anchor" href="#cities-on-a-map"><i class="fas fa-link"></i></a>
</h3>
<p>An easy to understand example of MDS starts with a matrix giving the distance between each pair of cities in a set. The MDS visualization then scatters these points across the plane, reconstructing the geographic separation of the points.</p>
<p>The dataset below is built from a database of world cities, selected to have only cities of more than 5 million plus some cities in Canada. I included a maximum of 4 cities per country so that one one region of the globe was too strongly concentrated in points. You can get the data from <a href="https://simplemaps.com/resources/free-country-cities">simplemaps</a> and make your own subset.</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cities</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"static/selected_cities.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   city = col_character(),
##   city_ascii = col_character(),
##   lat = col_double(),
##   lng = col_double(),
##   country = col_character(),
##   iso2 = col_character(),
##   iso3 = col_character(),
##   admin_name = col_character(),
##   capital = col_character(),
##   population = col_double(),
##   id = col_double()
## )</code></pre>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cities</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">lng</span>, y<span class="op">=</span><span class="va">lat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">city</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="122-mds_files/figure-html/unnamed-chunk-3-1.png" width="672"></div>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mymap</span> <span class="op">&lt;-</span> <span class="fu">get_stamenmap</span><span class="op">(</span>bbox <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>left <span class="op">=</span> <span class="op">-</span><span class="fl">150</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>, right <span class="op">=</span> <span class="fl">175</span>, top <span class="op">=</span> <span class="fl">75</span><span class="op">)</span>, zoom<span class="op">=</span><span class="fl">3</span>, maptype <span class="op">=</span> <span class="st">"terrain-background"</span><span class="op">)</span>
<span class="fu">ggmap</span><span class="op">(</span><span class="va">mymap</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cities</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">lng</span>, y<span class="op">=</span><span class="va">lat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cities</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span><span class="va">lng</span>, label<span class="op">=</span><span class="va">city</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="122-mds_files/figure-html/mds-map-cache-1.png" width="672"></div>
<p>Now we calculate the distance between all pairs of cities. I’ve shown two ways to do this – using great circle distance along the surface of the Earth, and using a distance that projects the surface of the Earth onto a plane first. If the goal is to reconstruct the map shown above, use this projected distance. If you would like instead to show great-circle distances between cities in the plane, use the geodesic distance.</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">city_distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">cities</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">lng</span>, <span class="va">lat</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co">#  distance in equirectangular projection</span>
  <span class="co"># https://en.wikipedia.org/wiki/Equirectangular_projection</span></code></pre></div>
<p>Perform <a href="https://en.wikipedia.org/wiki/Multidimensional_scaling">MDS</a> (principal coordinates analysis). The direction of the
two main axes could be reversed relative to the original map; I’ve reversed the x and y axes to match our customary view of the world.</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">city_distance</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mds1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1"</span>, <span class="st">"V2"</span><span class="op">)</span>
<span class="fu">bind_cols</span><span class="op">(</span><span class="va">cities</span>, <span class="fu">as_tibble</span><span class="op">(</span><span class="va">mds1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">city</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Map reconstructed from equirectangular distance matrix"</span>,
       x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="122-mds_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">city_distance</span> <span class="op">&lt;-</span> <span class="fu">rdist.earth</span><span class="op">(</span><span class="va">cities</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">lng</span>, <span class="va">lat</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span>, 
                             miles <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># geodesic distance</span>
<span class="va">mds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">city_distance</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mds1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1"</span>, <span class="st">"V2"</span><span class="op">)</span>
<span class="fu">bind_cols</span><span class="op">(</span><span class="va">cities</span>, <span class="fu">as_tibble</span><span class="op">(</span><span class="va">mds1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">city</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Map reconstructed from great-circle distance matrix"</span>,
       x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="122-mds_files/figure-html/unnamed-chunk-6-1.png" width="672"></div>
</div>
<div id="nmds-example" class="section level2" number="22.1">
<h2>
<span class="header-section-number">22.1</span> NMDS example<a class="anchor" aria-label="anchor" href="#nmds-example"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://en.wikipedia.org/wiki/Morse_code">Morse code</a> is a way of sending text messages using just two symbols: dot and dash, which was designed to be transmitted by a person clicking a key to make sounds and the receiver listening to the sounds and translating the message as it arrives.</p>
<p>The dataset below was created as part of an experiment to measure the rate at which patterns of sounds for one symbol were confused with sounds for a different symbol. The matrix is symmetric dissimilarity measure. Rows and columns vary across the 36 symbols tested (26 letters and 10 numeric digits). All diagonals are 0s. The off diagonal values are large if the sounds are not likely to be confuesed. Smaller dissimilarities correspond to symbols that are more likely to be confused. A small excerpt of the table is shown.</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">morse.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/zdealveindy/anadat-r/master/data/morsecodes-dist.txt'</span>,
                          row.names <span class="op">=</span> <span class="fl">1</span>, head <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">morse.dist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">morse.dist</span><span class="op">)</span>
<span class="va">morse.dist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, monospace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">column_spec</span><span class="op">(</span><span class="fl">1</span>, monospace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;font-family: monospace;">
</th>
<th style="text-align:right;font-family: monospace;">
.-
</th>
<th style="text-align:right;font-family: monospace;">
-…
</th>
<th style="text-align:right;font-family: monospace;">
-.-.
</th>
<th style="text-align:right;font-family: monospace;">
-..
</th>
<th style="text-align:right;font-family: monospace;">
.
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-family: monospace;">
.-
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
167
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
159
</td>
<td style="text-align:right;">
180
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
-…
</td>
<td style="text-align:right;">
167
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
163
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
-.-.
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
166
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
-..
</td>
<td style="text-align:right;">
159
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
172
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
.
</td>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
163
</td>
<td style="text-align:right;">
166
</td>
<td style="text-align:right;">
172
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table></div>
<p>Use the function <code>metaMDS</code> from the package <code>vegan</code> to perform the NMDS ordination. The <code>ordiplot</code> function shows the objects from the dissimilarity matrix on a two-dimensional “ordination plot”. Points that are closer together are more likely to be confused (they are less dissimilar).</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NMDS</span> <span class="op">&lt;-</span> <span class="fu">metaMDS</span><span class="op">(</span><span class="va">morse.dist</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="va">NMDS</span></code></pre></div>
<pre><code>## 
## Call:
## metaMDS(comm = morse.dist, trace = 0) 
## 
## global Multidimensional Scaling using monoMDS
## 
## Data:     morse.dist 
## Distance: user supplied 
## 
## Dimensions: 2 
## Stress:     0.1800255 
## Stress type 1, weak ties
## Two convergent solutions found after 20 tries
## Scaling: centring, PC rotation 
## Species: scores missing</code></pre>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ordiplot</span><span class="op">(</span><span class="va">NMDS</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, type <span class="op">=</span> <span class="st">'t'</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="122-mds_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># stressplot(NMDS)</span></code></pre></div>
<p>This next plot compares the distances in the original data to the distances as represented by the ordination. If the ordination represents the original data well, this will be close to a straight line. There is a point for every pairwise comparison. In this case there are 36 * 35 / 2 = 630 distances to compare. I have labeled some of the points with the largest distortion imposed by the ordination.</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">symbols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">NMDS</span><span class="op">$</span><span class="va">points</span><span class="op">)</span>
<span class="va">NMDS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dist"</span>, <span class="st">"dhat"</span>, <span class="st">"iidx"</span>, <span class="st">"jidx"</span><span class="op">)</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>comparison <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">symbols</span><span class="op">[</span><span class="va">iidx</span><span class="op">]</span>, <span class="st">"/"</span>, <span class="va">symbols</span><span class="op">[</span><span class="va">jidx</span><span class="op">]</span><span class="op">)</span>,
         comparison2 <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">dist</span><span class="op">-</span><span class="va">dhat</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">40</span> <span class="op">~</span> <span class="st">""</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">comparison</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dist</span>, <span class="va">dhat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">comparison2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="122-mds_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<p>You can also access the points from the ordination and make the “ordiplot” using ggplot. The relative position of points on the plat is the only thing that matters – any rotation or translation of the plot contains the same information.</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NMDS</span><span class="op">$</span><span class="va">points</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"Symbol"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MDS1</span>, y <span class="op">=</span> <span class="va">MDS2</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">Symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="122-mds_files/figure-html/unnamed-chunk-10-1.png" width="672"></div>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co"># geom_point(size = 0.5) + </span>
  <span class="co"># geom_text_repel(aes(label = Symbol))</span></code></pre></div>
<p>You might want to understand the NMDS analysis in terms of some properties of the Morse Code signals. This table has the length (1-5) and the ratio of short to long (dots and dashes) signals in each symbol. The <code>envfit</code> function then finds the direction each of these variables increases most rapidly across the ordination plane. The <code>summary</code> reports the direction and the correlation between these variables and the position on the ordination plot. The arrow for “length” follows the pattern in the ordination very well, while the arrow for the ratio of short to long only accounts for about half of the variation in the ordination plot.</p>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">morse.attr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/zdealveindy/anadat-r/master/data/morsecodes-attr.txt'</span>,
                         row.names <span class="op">=</span> <span class="fl">1</span>, head <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">ef</span> <span class="op">&lt;-</span> <span class="fu">envfit</span><span class="op">(</span><span class="va">NMDS</span>, <span class="va">morse.attr</span><span class="op">)</span>
<span class="va">ef</span></code></pre></div>
<pre><code>## 
## ***VECTORS
## 
##                     NMDS1    NMDS2     r2 Pr(&gt;r)    
## length            0.88381 -0.46784 0.9287  0.001 ***
## ratio.short.long -0.39383 -0.91918 0.5067  0.001 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## Permutation: free
## Number of permutations: 999</code></pre>
<p>The arrows show the direction of most rapid average increase of each variable.</p>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ordiplot</span><span class="op">(</span><span class="va">NMDS</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, type <span class="op">=</span> <span class="st">'t'</span><span class="op">)</span></code></pre></div>
<pre><code>## species scores not available</code></pre>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ef</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="122-mds_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
<p>Here is a method to reproduce this plot using <code>ggplot</code>. First use <code><a href="https://rdrr.io/r/utils/str.html">str(ef)</a></code> to examine the structure of the result from <code>envfit</code>. Then plot the points and arrows using ggplot.</p>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">arrows1</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">vectors</span><span class="op">$</span><span class="va">arrows</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"code"</span><span class="op">)</span>
<span class="fu">as_tibble</span><span class="op">(</span><span class="va">NMDS</span><span class="op">$</span><span class="va">points</span>, rownames <span class="op">=</span> <span class="st">"code"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MDS1</span>, y <span class="op">=</span> <span class="va">MDS2</span>, label <span class="op">=</span> <span class="va">code</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">arrows1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">*</span><span class="va">NMDS1</span>, y <span class="op">=</span> <span class="fl">25</span><span class="op">*</span><span class="va">NMDS2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">arrows1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">20</span><span class="op">*</span><span class="va">NMDS1</span>, y <span class="op">=</span> <span class="fl">20</span><span class="op">*</span><span class="va">NMDS2</span>, xend <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="122-mds_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
</div>
<div id="further-reading-16" class="section level2" number="22.2">
<h2>
<span class="header-section-number">22.2</span> Further reading<a class="anchor" aria-label="anchor" href="#further-reading-16"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<a href="https://cran.r-project.org/web/packages/vegan/vignettes/intro-vegan.pdf">Vegan</a> package and the <a href="https://github.com/gavinsimpson/ggvegan">ggvegan</a> package</li>
<li><a href="https://jonlefcheck.net/2012/10/24/nmds-tutorial-in-r/" class="uri">https://jonlefcheck.net/2012/10/24/nmds-tutorial-in-r/</a></li>
<li><a href="https://rpubs.com/collnellphd/GWU_nmds" class="uri">https://rpubs.com/collnellphd/GWU_nmds</a></li>
<li>
<a href="https://www.davidzeleny.net/anadat-r/doku.php/en:data:morse">Morse code</a> experiment description and <a href="https://www.davidzeleny.net/anadat-r/doku.php/en:pcoa_nmds_examples">analysis</a>
</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="pca.html"><span class="header-section-number">21</span> Principal component analysis</a></div>
<div class="next"><a href="k-means.html"><span class="header-section-number">23</span> K-means clustering</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#mds"><span class="header-section-number">22</span> Multidimensional scaling</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#cities-on-a-map"><span class="header-section-number">22.0.1</span> Cities on a map</a></li></ul>
</li>
<li><a class="nav-link" href="#nmds-example"><span class="header-section-number">22.1</span> NMDS example</a></li>
<li><a class="nav-link" href="#further-reading-16"><span class="header-section-number">22.2</span> Further reading</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/AndrewIrwin/data-visualization/blob/master/122-mds.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/AndrewIrwin/data-visualization/edit/master/122-mds.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Visualization</strong>" was written by Andrew Irwin. It was last built on 2021-02-25.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
