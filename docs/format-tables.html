<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 13 Format tables | Data Visualization</title>
<meta name="author" content="Andrew Irwin">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Visualization</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="syllabus.html">Syllabus</a></li>
<li><a class="" href="outline.html">Detailed outline</a></li>
<li><a class="" href="sync.html">Synchronous meeting agendas</a></li>
<li><a class="" href="evaluation.html">Evaluation</a></li>
<li><a class="" href="ch-invitation.html"><span class="header-section-number">1</span> Invitation to Data Visualization</a></li>
<li><a class="" href="ch-tools.html"><span class="header-section-number">2</span> Computer tools</a></li>
<li><a class="" href="setup.html"><span class="header-section-number">3</span> Setting up your computer</a></li>
<li><a class="" href="look-data.html"><span class="header-section-number">4</span> Look at Data</a></li>
<li><a class="" href="first-plot.html"><span class="header-section-number">5</span> Making your first plot</a></li>
<li><a class="" href="vcs.html"><span class="header-section-number">6</span> What is version control software?</a></li>
<li><a class="" href="grammar.html"><span class="header-section-number">7</span> Grammar of Graphics</a></li>
<li><a class="" href="ggplot.html"><span class="header-section-number">8</span> Using the grammar of graphics</a></li>
<li><a class="" href="summarizing-data.html"><span class="header-section-number">9</span> Summarizing data</a></li>
<li><a class="" href="facets.html"><span class="header-section-number">10</span> Facetted graphs</a></li>
<li><a class="" href="reading-data.html"><span class="header-section-number">11</span> Reading data</a></li>
<li><a class="" href="pivot.html"><span class="header-section-number">12</span> Reshaping data</a></li>
<li><a class="active" href="format-tables.html"><span class="header-section-number">13</span> Format tables</a></li>
<li><a class="" href="help.html"><span class="header-section-number">14</span> Getting help and asking questions</a></li>
<li><a class="" href="working-models.html"><span class="header-section-number">15</span> Working with models</a></li>
<li><a class="" href="linear-models.html"><span class="header-section-number">16</span> Linear models</a></li>
<li><a class="" href="smoothing.html"><span class="header-section-number">17</span> GAM and LOESS smoothing</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">18</span> Collaborating with GitHub</a></li>
<li><a class="" href="data-sources.html"><span class="header-section-number">19</span> Finding and accessing data</a></li>
<li><a class="" href="reproduce.html"><span class="header-section-number">20</span> Reproducible reports</a></li>
<li><a class="" href="pca.html"><span class="header-section-number">21</span> Principal component analysis</a></li>
<li><a class="" href="mds.html"><span class="header-section-number">22</span> Multidimensional scaling</a></li>
<li><a class="" href="k-means.html"><span class="header-section-number">23</span> K-means clustering</a></li>
<li><a class="" href="slides.html"><span class="header-section-number">24</span> Making slides for presentations</a></li>
<li><a class="" href="testing.html"><span class="header-section-number">25</span> Checking your work</a></li>
<li><a class="" href="dynamic.html"><span class="header-section-number">26</span> Dynamic graphics</a></li>
<li><a class="" href="mapping-1.html"><span class="header-section-number">27</span> Making maps</a></li>
<li><a class="" href="mapping-2.html"><span class="header-section-number">28</span> Mapping part two</a></li>
<li><a class="" href="mapping-3.html"><span class="header-section-number">29</span> Alternatives to maps</a></li>
<li><a class="" href="factors-dates.html"><span class="header-section-number">30</span> Working with factors and dates</a></li>
<li><a class="" href="colour.html"><span class="header-section-number">31</span> Using colour well</a></li>
<li><a class="" href="theme.html"><span class="header-section-number">32</span> Themes</a></li>
<li><a class="" href="output-files.html"><span class="header-section-number">33</span> Graphics formatting</a></li>
<li><a class="" href="organization.html"><span class="header-section-number">34</span> Staying organized</a></li>
<li><a class="" href="r-details.html"><span class="header-section-number">35</span> More details about R</a></li>
<li><a class="" href="accessibility-bias-and-ethics.html"><span class="header-section-number">36</span> Accessibility, Bias, and Ethics</a></li>
<li><a class="" href="metadata.html">Metadata</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/AndrewIrwin/data-visualization">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="format-tables" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> Format tables<a class="anchor" aria-label="anchor" href="#format-tables"><i class="fas fa-link"></i></a>
</h1>
<p>We’re spending a lot of time in this course making graphic visualizations of data. In this one lesson we will take a detour and learn to make nice looking tables with text and numbers in them. There are a bunch of packages for doing this (see Assignment X). We’ll use the <code>kable</code> table formatting function in this lesson (from the packages <code>knitr</code> and <code>kableExtra</code>).</p>
<p>Let’s use a simple table to demonstrate the main features. I want some text, some numbers, and not too many rows or columns. I’ll summarize the data in the <code>palmerpenguins</code> table into a small table.</p>
<pre><code>## # A tibble: 5 x 4
##   species   island    count body_mass_g
## * &lt;fct&gt;     &lt;fct&gt;     &lt;int&gt;       &lt;dbl&gt;
## 1 Adelie    Biscoe       44       3710.
## 2 Adelie    Dream        56       3688.
## 3 Adelie    Torgersen    51       3706.
## 4 Chinstrap Dream        68       3733.
## 5 Gentoo    Biscoe      123       5076.</code></pre>
<p>The function <code>kable</code> turns this into a formatted table.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">kable</span><span class="op">(</span><span class="va">t1</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
island
</th>
<th style="text-align:right;">
count
</th>
<th style="text-align:right;">
body_mass_g
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
3709.659
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
3688.393
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Torgersen
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
3706.373
</td>
</tr>
<tr>
<td style="text-align:left;">
Chinstrap
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
3733.088
</td>
</tr>
<tr>
<td style="text-align:left;">
Gentoo
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
5076.016
</td>
</tr>
</tbody>
</table></div>
<div id="header-rows" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Header rows<a class="anchor" aria-label="anchor" href="#header-rows"><i class="fas fa-link"></i></a>
</h2>
<p>Often you will want to rename or reformat the column headings. There are two ways to do this: using <code>rename</code> to change the actual column names before formatting the table, or using column formatting to just affect the table appearance. You can rename just one column using <code>rename</code>, but with the second version below (<code>col.names</code>) you need to provide all the column names in the correct order.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">rename</span><span class="op">(</span>`Body mass (g)` <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
island
</th>
<th style="text-align:right;">
count
</th>
<th style="text-align:right;">
Body mass (g)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
3709.659
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
3688.393
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Torgersen
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
3706.373
</td>
</tr>
<tr>
<td style="text-align:left;">
Chinstrap
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
3733.088
</td>
</tr>
<tr>
<td style="text-align:left;">
Gentoo
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
5076.016
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Island"</span>, <span class="st">"Count"</span>,  <span class="st">"Body mass (g)"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
Species
</th>
<th style="text-align:left;">
Island
</th>
<th style="text-align:right;">
Count
</th>
<th style="text-align:right;">
Body mass (g)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
3709.659
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
3688.393
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Torgersen
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
3706.373
</td>
</tr>
<tr>
<td style="text-align:left;">
Chinstrap
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
3733.088
</td>
</tr>
<tr>
<td style="text-align:left;">
Gentoo
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
5076.016
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="column-alignment" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> Column alignment<a class="anchor" aria-label="anchor" href="#column-alignment"><i class="fas fa-link"></i></a>
</h2>
<p>Commonly numbers are right justified and text is left justified. That’s what’s done automatically. You can specify each column as left, centre, or right justified using the letters l, c, or r for each column. Here we’ll center the justify the numbers to demonstrate.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span>align <span class="op">=</span> <span class="st">"llcc"</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
island
</th>
<th style="text-align:center;">
count
</th>
<th style="text-align:center;">
body_mass_g
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:center;">
44
</td>
<td style="text-align:center;">
3709.659
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:center;">
56
</td>
<td style="text-align:center;">
3688.393
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Torgersen
</td>
<td style="text-align:center;">
51
</td>
<td style="text-align:center;">
3706.373
</td>
</tr>
<tr>
<td style="text-align:left;">
Chinstrap
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:center;">
68
</td>
<td style="text-align:center;">
3733.088
</td>
</tr>
<tr>
<td style="text-align:left;">
Gentoo
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:center;">
123
</td>
<td style="text-align:center;">
5076.016
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="formatting-numbers" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> Formatting numbers<a class="anchor" aria-label="anchor" href="#formatting-numbers"><i class="fas fa-link"></i></a>
</h2>
<p>Any number that comes from a calculation (such as a mean) will have a lot of decimal places displayed unless you change this. You can control the number of decimal places to show using rounding. (Use a negative number of digits to round to the left of the decimal point, for example <code>digits=-1</code> to round to the tens place.) Give either one number to use for all columns, or provide a vector to control the number of digits separately for each column.</p>
<p>You can add a comma (or space for SI or . for European styles) to separate the thousands or millions using <code>format.args = list(big.mark = ",")</code>. See the help for <code>format</code> for more options.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span>, format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
island
</th>
<th style="text-align:right;">
count
</th>
<th style="text-align:right;">
body_mass_g
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
3,709.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
3,688.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Torgersen
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
3,706.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Chinstrap
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
3,733.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Gentoo
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
5,076.0
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="color-highlights-and-other-styles" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> Color, highlights, and other styles<a class="anchor" aria-label="anchor" href="#color-highlights-and-other-styles"><i class="fas fa-link"></i></a>
</h2>
<p>There are a lot of options for changing the appearance of text in the <code>kableExtra</code> package. If you are interested, look at the <a href="https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html">vignette</a> linked in the further reading.</p>
<p>The two styles I use frequently are alternating shading to help you read across rows and making the columns only wide enough to display your data.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span>, bootstrap_options <span class="op">=</span> <span class="st">"striped"</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
island
</th>
<th style="text-align:right;">
count
</th>
<th style="text-align:right;">
body_mass_g
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
3709.659
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
3688.393
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Torgersen
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
3706.373
</td>
</tr>
<tr>
<td style="text-align:left;">
Chinstrap
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
3733.088
</td>
</tr>
<tr>
<td style="text-align:left;">
Gentoo
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
5076.016
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="captions" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> Captions<a class="anchor" aria-label="anchor" href="#captions"><i class="fas fa-link"></i></a>
</h2>
<p>You can add a caption to a table with the <code>caption</code> argument to <code>kable</code>.</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"The number and average mass of penguins by species and island."</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:unnamed-chunk-8">Table 13.1: </span>The number and average mass of penguins by species and island.
</caption>
<thead><tr>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
island
</th>
<th style="text-align:right;">
count
</th>
<th style="text-align:right;">
body_mass_g
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
3709.659
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
3688.393
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Torgersen
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
3706.373
</td>
</tr>
<tr>
<td style="text-align:left;">
Chinstrap
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
3733.088
</td>
</tr>
<tr>
<td style="text-align:left;">
Gentoo
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
5076.016
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="putting-it-all-together" class="section level2" number="13.6">
<h2>
<span class="header-section-number">13.6</span> Putting it all together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"><i class="fas fa-link"></i></a>
</h2>
<p>Usually you will want to combine these features to get the look you want. Your goal should always be to make a table that clearly displays your data.</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span>, format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,
             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Island"</span>, <span class="st">"n"</span>, <span class="st">"Body mass (g)"</span><span class="op">)</span>,
             caption<span class="op">=</span><span class="st">"The number and average mass of penguins by species and island."</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span>, bootstrap_options <span class="op">=</span> <span class="st">"striped"</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-9">Table 13.2: </span>The number and average mass of penguins by species and island.
</caption>
<thead><tr>
<th style="text-align:left;">
Species
</th>
<th style="text-align:left;">
Island
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
Body mass (g)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
3,709.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
3,688.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:left;">
Torgersen
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
3,706.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Chinstrap
</td>
<td style="text-align:left;">
Dream
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
3,733.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Gentoo
</td>
<td style="text-align:left;">
Biscoe
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
5,076.0
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="adding-row-and-column-totals" class="section level2" number="13.7">
<h2>
<span class="header-section-number">13.7</span> Adding row and column totals<a class="anchor" aria-label="anchor" href="#adding-row-and-column-totals"><i class="fas fa-link"></i></a>
</h2>
<p>We frequently make tables of counts of categorical variables. In these tables it can be helpful to add column or row totals. Sometimes we want to report those totals as percentages of a grand total. The <code>janitor</code> package makes it easy to add totals and percentages to rows and columns.</p>
<p>We’ll start with a matrix of counts showing the number of countries with life expectancy more than 75 years in each year and continent.</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">lifeExp</span> <span class="op">&gt;</span> <span class="fl">75</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span>, <span class="va">continent</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"continent"</span>, values_from <span class="op">=</span> <span class="st">"n"</span>, values_fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'year'. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span></code></pre></div>
<pre><code>## # A tibble: 7 x 6
## # Groups:   year [7]
##    year  Asia Europe Americas Oceania Africa
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;    &lt;int&gt;   &lt;int&gt;  &lt;int&gt;
## 1  1977     1      5        0       0      0
## 2  1982     2      7        1       0      0
## 3  1987     3     11        2       1      0
## 4  1992     5     17        3       2      0
## 5  1997     6     19        5       2      0
## 6  2002     7     20        7       2      1
## 7  2007     9     22       10       2      1</code></pre>
<p>Now we will add row totals. No sum is computed for the first column since it is assumed to be a label.</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">adorn_totals</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##   year Asia Europe Americas Oceania Africa
##   1977    1      5        0       0      0
##   1982    2      7        1       0      0
##   1987    3     11        2       1      0
##   1992    5     17        3       2      0
##   1997    6     19        5       2      0
##   2002    7     20        7       2      1
##   2007    9     22       10       2      1
##  Total   33    101       28       9      2</code></pre>
<p>If you think about this, you’ll realize this doesn’t make much sense! So let’s add column totals instead. Again the first column is ignored, assuming it is a label.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">adorn_totals</span><span class="op">(</span>where <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span> </code></pre></div>
<pre><code>##  year Asia Europe Americas Oceania Africa Total
##  1977    1      5        0       0      0     6
##  1982    2      7        1       0      0    10
##  1987    3     11        2       1      0    17
##  1992    5     17        3       2      0    27
##  1997    6     19        5       2      0    32
##  2002    7     20        7       2      1    37
##  2007    9     22       10       2      1    44</code></pre>
<p>These tables are formatted differently compared to <code>data.frames</code> and <code>tibbles</code>, but they can still be reformatted as you would expect using <code>%&gt;% kable() %&gt;% kable_styling()</code>.</p>
<p>Incidentally, the <code>janitor</code> package has a powerful table generating function <code>tabyl</code> which does the counting we started this section with. We still need the <code>filter</code> to retain only rows with life expectancy more than 75 years. The columns are reported alphabetically instead of according to the order they appear in the original dataset.</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gapminder</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">lifeExp</span> <span class="op">&gt;</span> <span class="fl">75</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tabyl</span><span class="op">(</span><span class="va">year</span>, <span class="va">continent</span><span class="op">)</span> <span class="co">#  %&gt;% adorn_totals(where="col")</span></code></pre></div>
<pre><code>##  year Africa Americas Asia Europe Oceania
##  1977      0        0    1      5       0
##  1982      0        1    2      7       0
##  1987      0        2    3     11       1
##  1992      0        3    5     17       2
##  1997      0        5    6     19       2
##  2002      1        7    7     20       2
##  2007      1       10    9     22       2</code></pre>
</div>
<div id="adding-grouping-for-rows-and-columns" class="section level2" number="13.8">
<h2>
<span class="header-section-number">13.8</span> Adding grouping for rows and columns<a class="anchor" aria-label="anchor" href="#adding-grouping-for-rows-and-columns"><i class="fas fa-link"></i></a>
</h2>
<p>Sometimes it is desirable to add a grouping label over a series of columns. For example, the in the table showing totals above, we can add a header “Continent” over the appropriate columns. We do this to a <code>kable</code> formatted table using the function <code>add_header_row</code>. This function takes an argument which is a vector of pairs: labels for each column and the number of columns that label should span. There must be enough lables to span all the columns. We will add a blank label for the first and last column (spanning 1 column each), and a label “Continent” spanning the 5 continents.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">adorn_totals</span><span class="op">(</span>where <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">" "</span> <span class="op">=</span> <span class="fl">1</span>, 
                  <span class="st">"Continent"</span> <span class="op">=</span> <span class="fl">5</span>,
                  <span class="st">" "</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Continent
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
</tr>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
Asia
</th>
<th style="text-align:right;">
Europe
</th>
<th style="text-align:right;">
Americas
</th>
<th style="text-align:right;">
Oceania
</th>
<th style="text-align:right;">
Africa
</th>
<th style="text-align:right;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1977
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
1982
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:right;">
1987
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
17
</td>
</tr>
<tr>
<td style="text-align:right;">
1992
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:right;">
1997
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
44
</td>
</tr>
</tbody>
</table></div>
<p>It can also be helpful to add grouping to rows. For example, we could label the first 5 rows as being part of the 20th century and the last 2 rows as being part of the 21st century. We add row labels one at a time, giving a label for the row and the numbers of the rows the header should span. We will do this with the <code>kableExtra</code> function <code>group_rows</code>.</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t1</span> <span class="op">%&gt;%</span> <span class="fu">adorn_totals</span><span class="op">(</span>where <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_rows</span><span class="op">(</span><span class="st">"20th century"</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_rows</span><span class="op">(</span><span class="st">"21st century"</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
Asia
</th>
<th style="text-align:right;">
Europe
</th>
<th style="text-align:right;">
Americas
</th>
<th style="text-align:right;">
Oceania
</th>
<th style="text-align:right;">
Africa
</th>
<th style="text-align:right;">
Total
</th>
</tr></thead>
<tbody>
<tr grouplength="5">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>20th century</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
1977
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
1982
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
1987
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
17
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
1992
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
1997
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>21st century</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2002
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2007
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
44
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="further-reading-8" class="section level2" number="13.9">
<h2>
<span class="header-section-number">13.9</span> Further reading<a class="anchor" aria-label="anchor" href="#further-reading-8"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Using <a href="https://bookdown.org/yihui/rmarkdown-cookbook/kable.html">kable</a> to format tables</li>
<li>Vignette on using <a href="https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html">kable and kableExtra</a>
</li>
<li><a href="https://people.ok.ubc.ca/jpither/modules/Tables_markdown.html" class="uri">https://people.ok.ubc.ca/jpither/modules/Tables_markdown.html</a></li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="pivot.html"><span class="header-section-number">12</span> Reshaping data</a></div>
<div class="next"><a href="help.html"><span class="header-section-number">14</span> Getting help and asking questions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#format-tables"><span class="header-section-number">13</span> Format tables</a></li>
<li><a class="nav-link" href="#header-rows"><span class="header-section-number">13.1</span> Header rows</a></li>
<li><a class="nav-link" href="#column-alignment"><span class="header-section-number">13.2</span> Column alignment</a></li>
<li><a class="nav-link" href="#formatting-numbers"><span class="header-section-number">13.3</span> Formatting numbers</a></li>
<li><a class="nav-link" href="#color-highlights-and-other-styles"><span class="header-section-number">13.4</span> Color, highlights, and other styles</a></li>
<li><a class="nav-link" href="#captions"><span class="header-section-number">13.5</span> Captions</a></li>
<li><a class="nav-link" href="#putting-it-all-together"><span class="header-section-number">13.6</span> Putting it all together</a></li>
<li><a class="nav-link" href="#adding-row-and-column-totals"><span class="header-section-number">13.7</span> Adding row and column totals</a></li>
<li><a class="nav-link" href="#adding-grouping-for-rows-and-columns"><span class="header-section-number">13.8</span> Adding grouping for rows and columns</a></li>
<li><a class="nav-link" href="#further-reading-8"><span class="header-section-number">13.9</span> Further reading</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/AndrewIrwin/data-visualization/blob/master/113-data-tables.rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/AndrewIrwin/data-visualization/edit/master/113-data-tables.rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Visualization</strong>" was written by Andrew Irwin. It was last built on 2021-03-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
